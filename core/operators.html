<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>
            
    
    运算符参考
 &mdash;
    SQLAlchemy 2.0 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/default.css" type="text/css" />
                <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 2.0 Documentation" href="../index.html" />
        <link rel="up" title="SQL语句和表达式API" href="expression_api.html" />
        <link rel="next" title="选择和相关结构" href="selectable.html" />
        <link rel="prev" title="列元素和表达式" href="sqlelement.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">2.0.19</span>


        | Release Date: July 15, 2023

    </div>

    <h1><a href="../index.html">SQLAlchemy 2.0 Documentation</a></h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">



        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 2.0 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../index.html">Home</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="SQLAlchemy 核心">SQLAlchemy 核心</a>
        </h3>

        <ul>
<li><span class="link-container"><a class="reference external" href="expression_api.html">SQL语句和表达式API</a></span><ul>
<li><span class="link-container"><a class="reference external" href="sqlelement.html">列元素和表达式</a></span></li>
<li class="selected"><span class="link-container"><strong>运算符参考</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#id2">比较运算符</a></span></li>
<li><span class="link-container"><a class="reference external" href="#in">IN 比较</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#id3">针对值列表的 IN</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id4">空的 IN 表达式</a></span></li>
<li><span class="link-container"><a class="reference external" href="#not-in">NOT IN</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id5">元组 IN 表达式</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id6">子查询 IN</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#id7">恒等比较</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id8">字符串比较</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id9">字符串包含</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id10">字符串匹配</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id11">算术运算符</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id12">位运算符</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id13">使用连接和否定</a></span></li>
<li><span class="link-container"><a class="reference external" href="#id14">连接操作符</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="selectable.html">选择和相关结构</a></span></li>
<li><span class="link-container"><a class="reference external" href="dml.html">插入、更新、删除</a></span></li>
<li><span class="link-container"><a class="reference external" href="functions.html">SQL和通用函数</a></span></li>
<li><span class="link-container"><a class="reference external" href="compiler.html">自定义SQL构造和编译扩展</a></span></li>
<li><span class="link-container"><a class="reference external" href="serializer.html">表达式序列化器扩展</a></span></li>
<li><span class="link-container"><a class="reference external" href="foundation.html">SQL表达式语言基础构造</a></span></li>
<li><span class="link-container"><a class="reference external" href="visitors.html">游客和遍历工具</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="schema.html">模式定义语言 (Schema Definition Language)</a></span></li>
<li><span class="link-container"><a class="reference external" href="types.html">SQL 数据类型对象</a></span></li>
<li><span class="link-container"><a class="reference external" href="engines_connections.html">引擎与连接使用</a></span></li>
<li><span class="link-container"><a class="reference external" href="api_basics.html">Core API基础知识</a></span></li>
</ul>



        </div>

        </div>

    </div>

    <div id="narrow-index-nav">
        <form class="search" action="../search.html" method="get">
            <label>
                Search terms:
            <input type="text" placeholder="search..." name="q" size="12" />
            </label>
            <input type="submit" value="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>

        <p>
        <a href="../index.html">Home</a>
        </p>

    </div>


        <div id="docs-narrow-top-navigation">
            <ul>
                <li><b>Previous:</b>
                <a href="sqlelement.html" title="previous chapter">列元素和表达式</a></li>
                <li><b>Next:</b>
                <a href="selectable.html" title="next chapter">选择和相关结构</a></li>

            <li><b>Up:</b> <a href="../index.html">Home</a></li>
                    <ul><li><a href="index.html" title="SQLAlchemy 核心">SQLAlchemy 核心</a></li>
                    <ul><li><a href="expression_api.html" title="SQL语句和表达式API">SQL语句和表达式API</a></li>
                </ul>
                </ul>



            <li><b>On this page:</b></li>
            <ul>
<li><a class="reference internal" href="#id1">运算符参考</a><ul>
<li><a class="reference internal" href="#id2">比较运算符</a></li>
<li><a class="reference internal" href="#in">IN 比较</a><ul>
<li><a class="reference internal" href="#id3">针对值列表的 IN</a></li>
<li><a class="reference internal" href="#id4">空的 IN 表达式</a></li>
<li><a class="reference internal" href="#not-in">NOT IN</a></li>
<li><a class="reference internal" href="#id5">元组 IN 表达式</a></li>
<li><a class="reference internal" href="#id6">子查询 IN</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">恒等比较</a></li>
<li><a class="reference internal" href="#id8">字符串比较</a></li>
<li><a class="reference internal" href="#id9">字符串包含</a></li>
<li><a class="reference internal" href="#id10">字符串匹配</a></li>
<li><a class="reference internal" href="#id11">算术运算符</a></li>
<li><a class="reference internal" href="#id12">位运算符</a></li>
<li><a class="reference internal" href="#id13">使用连接和否定</a></li>
<li><a class="reference internal" href="#id14">连接操作符</a></li>
</ul>
</li>
</ul>


            </ul>

        </div>



    <div id="docs-body" role="main" class="withsidebar core-operators" >
        
<section id="id1">
<h1>运算符参考<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h1>
<p>本节详细介绍了用于构建 SQL 表达式的运算符。</p>
<p>这些方法按照   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Operators" title="sqlalchemy.sql.expression.Operators"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operators</span></code></a>  和   :class:` _sql.ColumnOperators`  基类展示。然后，这些方法可以在这些类的子类中使用，包括：</p>
<ul class="simple">
<li><p><a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a>  对象</p></li>
<li><p>更一般的   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColumnElement</span></code></a>  对象，它们是所有基于 Core SQL 表达式语言的列级表达式的根。</p></li>
<li><p><a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.InstrumentedAttribute" title="sqlalchemy.orm.InstrumentedAttribute"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstrumentedAttribute</span></code></a>  对象，这是 ORM 级别的映射属性。</p></li>
</ul>
<p>这些运算符首先在教程性部分中介绍，包括：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../tutorial/index.html"><span class="doc">SQLAlchemy统一教程</span></a>  - 统一教程，采用  :term:` 2.0 风格`</p></li>
<li><p><a class="reference internal" href="../orm/tutorial.html"><span class="doc">&lt;no title&gt;</span></a>  - ORM 教程，采用  :term:` 1.x 风格`</p></li>
<li><p><a class="reference internal" href="tutorial.html"><span class="doc">Introduction</span></a>  - Core 教程，采用  :term:` 1.x 风格`</p></li>
</ul>
<section id="id2">
<h2>比较运算符<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<p>适用于许多数据类型（包括数值、字符串、日期和许多其他类型）的基本比较运算符：</p>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__eq__" title="sqlalchemy.sql.expression.ColumnOperators.__eq__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__eq__()</span></code></a> （Python “` <cite>==`</cite>” 运算符）</p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span>
</div></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__ne__" title="sqlalchemy.sql.expression.ColumnOperators.__ne__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__ne__()</span></code></a> （Python “` <cite>!=`</cite>” 运算符）</p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">)</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span>
</div></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__gt__" title="sqlalchemy.sql.expression.ColumnOperators.__gt__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__gt__()</span></code></a> （Python “` <cite>&gt;`</cite>” 运算符）</p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span>
</div></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__lt__" title="sqlalchemy.sql.expression.ColumnOperators.__lt__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__lt__()</span></code></a> （Python “` <cite>&lt;`</cite>” 运算符）</p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span>
</div></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__ge__" title="sqlalchemy.sql.expression.ColumnOperators.__ge__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__ge__()</span></code></a> （Python “` <cite>&gt;=`</cite>” 运算符）</p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span>
</div></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__le__" title="sqlalchemy.sql.expression.ColumnOperators.__le__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__le__()</span></code></a> （Python “` <cite>&lt;=`</cite>” 运算符）</p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span>
</div></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.between" title="sqlalchemy.sql.expression.ColumnOperators.between"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.between()</span></code></a></p></li>
</ul>
<blockquote>
<div><div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<div class='show_sql_print'><span class="n">x</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="p">:</span><span class="n">x_1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">:</span><span class="n">x_2</span>
</div></pre></div>
</div>
</div></blockquote>
</section>
<section id="in">
<h2>IN 比较<a class="headerlink" href="#in" title="Permalink to this heading">¶</a></h2>
<p>SQL 的 IN 运算符在 SQLAlchemy 中是一个特殊的话题。由于 IN 运算符通常用于与一组固定值的匹配，因此 SQLAlchemy 的参数绑定强制特性使用一种特殊的 SQL 编译形式，该形式在编译时被渲染为中间形式 SQL 字符串，并以第二步形成最终的绑定的参数列表。换句话说，”它只是工作”。</p>
<section id="id3">
<h3>针对值列表的 IN<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>IN 最常见，通常是通过将列表传递给  <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.in_" title="sqlalchemy.sql.expression.ColumnOperators.in_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.in_()</span></code></a>  方法来使用的：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">{printsql}x IN (__[POSTCOMPILE_x_1])</span></pre></div>
</div>
<p>在执行时，这里的特殊绑定形式”__[POSTCOMPILE”将呈现为单个参数:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
<div class='show_sql'><span class="k">SELECT</span><span class="w"> </span><span class="n">user_account</span><span class="p">.</span><span class="n">id</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">user_account</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">user_account</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="p">)</span>
<span class="p">[...]</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
</div></pre></div>
</div>
</section>
<section id="id4">
<h3>空的 IN 表达式<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<p>对于空的 IN 表达式，SQLAlchemy 生成一个数学上有效的结果，通过渲染出一种针对特定后端的子查询来返回 0 行。换句话说，”它只是工作”:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">([]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
<div class='show_sql'><span class="k">SELECT</span><span class="w"> </span><span class="n">user_account</span><span class="p">.</span><span class="n">id</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">user_account</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">user_account</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="mi">1</span><span class="o">!=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[...]</span><span class="w"> </span><span class="p">()</span>
</div></pre></div>
</div>
<p>上面的 “空集” 子查询是正确的，并且是基于保持 IN 运算符不变形渲染出的。</p>
</section>
<section id="not-in">
<h3>NOT IN<a class="headerlink" href="#not-in" title="Permalink to this heading">¶</a></h3>
<p>“NOT IN” 可以通过  <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.not_in" title="sqlalchemy.sql.expression.ColumnOperators.not_in"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.not_in()</span></code></a>  运算符使用：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">not_in</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">{printsql}(x NOT IN (__[POSTCOMPILE_x_1]))</span></pre></div>
</div>
<p>通常，可以使用 “~” 运算符来否定它：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="o">~</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">{printsql}(x NOT IN (__[POSTCOMPILE_x_1]))</span></pre></div>
</div>
</section>
<section id="id5">
<h3>元组 IN 表达式<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>将元组与元组进行比较是常见的 IN 使用情况，其中包括将行与一组潜在的复合主键值进行匹配的情况。  <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.tuple_" title="sqlalchemy.sql.expression.tuple_"><code class="xref py py-func docutils literal notranslate"><span class="pre">tuple_()</span></code></a>  构造为元组比较提供了基本的构建块。然后，  :meth:` _sql.Tuple.in_`   运算符接收元组列表：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">tuple_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">tuple_</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">tup</span><span class="o">.</span><span class="n">in_</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">{printsql}(x, y) IN (__[POSTCOMPILE_param_1])</span></pre></div>
</div>
<p>为了说明渲染的参数：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">tuple_</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">Address</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tup</span><span class="o">.</span><span class="n">in_</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">{execsql}SELECT user_account.name</span>
<span class="go">FROM user_account JOIN address ON user_account.id = address.user_id</span>
<span class="go">WHERE (user_account.id, address.id) IN (VALUES (?, ?), (?, ?))</span>
<span class="go">[...] (1, 1, 2, 2){stop}</span>
<span class="go">[(&#39;spongebob&#39;,), (&#39;sandy&#39;,)]</span></pre></div>
</div>
</section>
<section id="id6">
<h3>子查询 IN<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<p>最后，  <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.in_" title="sqlalchemy.sql.expression.ColumnOperators.in_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.in_()</span></code></a>   和  :meth:` _sql.ColumnOperators.not_in`  运算符可以使用子查询。此表单提供直接传递   <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select" title="sqlalchemy.sql.expression.Select"><code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code></a>  构造的形式，而不需要显式转换为命名子查询：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">user_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)))</span>
<span class="go">{printsql}x IN (SELECT user_account.id</span>
<span class="go">FROM user_account)</span></pre></div>
</div>
<p>元组按预期工作：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">tuple_</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">select</span><span class="p">(</span><span class="n">user_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">address_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">address_table</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">{printsql}(x, y) IN (SELECT user_account.id, address.id</span>
<span class="go">FROM user_account JOIN address ON user_account.id = address.user_id)</span></pre></div>
</div>
<p>此运算符提供了一个快捷处理子查询和预设复合运算的功能。</p>
</section>
</section>
<section id="id7">
<h2>恒等比较<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<p>这些运算符涉及测试特殊 SQL 值，例如某些数据库支持的 <code class="docutils literal notranslate"><span class="pre">NULL</span></code>、布尔常量，等等：</p>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.is_" title="sqlalchemy.sql.expression.ColumnOperators.is_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.is_()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>该运算符将正好提供”<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">IS</span> <span class="pre">y</span></code>”的 SQL 表示形式，通常被视为 “&lt;expr&gt; 是 NULL”。可以使用普通的 Python <code class="docutils literal notranslate"><span class="pre">None</span></code> 获得 <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 常量：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="go">{printsql}x IS NULL</span></pre></div>
</div>
<p>SQL 中的 NULL 也是显式可用的，如果需要，可以使用   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.null" title="sqlalchemy.sql.expression.null"><code class="xref py py-func docutils literal notranslate"><span class="pre">null()</span></code></a>  构造：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">null</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="n">null</span><span class="p">()))</span>
<span class="go">{printsql}x IS NULL</span></pre></div>
</div>
<p>在与动态值一起使用时，通常不需要显式使用  <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.is_" title="sqlalchemy.sql.expression.ColumnOperators.is_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.is_()</span></code></a> ，特别是在使用  :meth:` _sql.ColumnOperators.__eq__`  连载运算符（例如，”==”）与 <code class="docutils literal notranslate"><span class="pre">None</span></code> 或   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.null" title="sqlalchemy.sql.expression.null"><code class="xref py py-func docutils literal notranslate"><span class="pre">null()</span></code></a>  值一起使用时。这样就不需要显式使用  :meth:` _sql.ColumnOperators.is_` ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
<span class="go">{printsql}x IS NULL</span></pre></div>
</div>
<p>请注意，Python <code class="docutils literal notranslate"><span class="pre">is</span></code> 运算符**不重载**。即使 Python 提供了钩子以重载运算符例如 <code class="docutils literal notranslate"><span class="pre">==</span></code> 和 <code class="docutils literal notranslate"><span class="pre">!=</span></code>，但它并**没有**提供任何方式来重新定义 <code class="docutils literal notranslate"><span class="pre">is</span></code>。</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.is_not" title="sqlalchemy.sql.expression.ColumnOperators.is_not"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.is_not()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>类似于  <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.is_" title="sqlalchemy.sql.expression.ColumnOperators.is_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.is_()</span></code></a> ，生成 “IS NOT”：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="go">{printsql}x IS NOT NULL</span></pre></div>
</div>
<p>等同于 “!= None”：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">{printsql}x IS NOT NULL</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.is_distinct_from" title="sqlalchemy.sql.expression.ColumnOperators.is_distinct_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.is_distinct_from()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>生成 SQL IS DISTINCT FROM：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_distinct_from</span><span class="p">(</span><span class="s2">&quot;some value&quot;</span><span class="p">))</span>
<span class="go">{printsql}x IS DISTINCT FROM :x_1</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.isnot_distinct_from" title="sqlalchemy.sql.expression.ColumnOperators.isnot_distinct_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.isnot_distinct_from()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>生成 SQL IS NOT DISTINCT FROM：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isnot_distinct_from</span><span class="p">(</span><span class="s2">&quot;some value&quot;</span><span class="p">))</span>
<span class="go">{printsql}x IS NOT DISTINCT FROM :x_1</span></pre></div>
</div>
</div></blockquote>
</section>
<section id="id8">
<h2>字符串比较<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.like" title="sqlalchemy.sql.expression.ColumnOperators.like"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.like()</span></code></a> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}x LIKE :x_1</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.ilike" title="sqlalchemy.sql.expression.ColumnOperators.ilike"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.ilike()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>不区分大小写 LIKE 利用通用后端上的 SQL <code class="docutils literal notranslate"><span class="pre">lower()</span></code> 函数。在 PostgreSQL 上，它将使用 <code class="docutils literal notranslate"><span class="pre">ILIKE</span></code>：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ilike</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}lower(x) LIKE lower(:x_1)</span></pre></div>
</div>
</div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.notlike" title="sqlalchemy.sql.expression.ColumnOperators.notlike"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.notlike()</span></code></a> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">notlike</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}x NOT LIKE :x_1</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.notilike" title="sqlalchemy.sql.expression.ColumnOperators.notilike"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.notilike()</span></code></a> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">notilike</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}lower(x) NOT LIKE lower(:x_1)</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
</section>
<section id="id9">
<h2>字符串包含<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h2>
<p>许多后端的字符串包含运算符都是建立在 LIKE 和字符串连接运算符的组合上的，后者在大多数后端上是”||”，有时是像 “concat()” 的函数：</p>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.startswith" title="sqlalchemy.sql.expression.ColumnOperators.startswith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.startswith()</span></code></a> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}x LIKE :x_1 || &#39;%&#39;</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.endswith" title="sqlalchemy.sql.expression.ColumnOperators.endswith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.endswith()</span></code></a> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}x LIKE &#39;%&#39; || :x_1</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.contains" title="sqlalchemy.sql.expression.ColumnOperators.contains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.contains()</span></code></a> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}x LIKE &#39;%&#39; || :x_1 || &#39;%&#39;</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
</section>
<section id="id10">
<h2>字符串匹配<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<p>匹配运算符始终是特定于后端的，并且可能在不同的数据库上提供不同的行为和结果：</p>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.match" title="sqlalchemy.sql.expression.ColumnOperators.match"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.match()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>该运算符是方言特定的，如果底层数据库支持，则使用底层数据库的 MATCH 功能：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">))</span>
<span class="go">{printsql}x MATCH :x_1</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.regexp_match" title="sqlalchemy.sql.expression.ColumnOperators.regexp_match"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.regexp_match()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>该操作符是特定于方言的。我们可以用以 PostgreSQL 方言为例：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects</span> <span class="kn">import</span> <span class="n">postgresql</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">regexp_match</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">postgresql</span><span class="o">.</span><span class="n">dialect</span><span class="p">()))</span>
<span class="go">{printsql}x ~ %(x_1)s</span></pre></div>
</div>
<p>或者是对于 MySQL：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects</span> <span class="kn">import</span> <span class="n">mysql</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">regexp_match</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">mysql</span><span class="o">.</span><span class="n">dialect</span><span class="p">()))</span>
<span class="go">{printsql}x REGEXP %s</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.regexp_replace" title="sqlalchemy.sql.expression.ColumnOperators.regexp_replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.regexp_replace()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>与  <code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.regexp()</span></code>  互补，为具有该支持功能的后端生成等价的 REGEX REPLACE：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">regexp_replace</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">postgresql</span><span class="o">.</span><span class="n">dialect</span><span class="p">()))</span>
<span class="go">{printsql}REGEXP_REPLACE(x, %(x_1)s, %(x_2)s)</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.collate" title="sqlalchemy.sql.expression.ColumnOperators.collate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.collate()</span></code></a> ：</p></li>
</ul>
<blockquote>
<div><p>生成 COLLATE SQL 运算符，它在表达式时间提供特定的排序方式:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span>
<span class="go">...     (column(&quot;x&quot;).collate(&quot;latin1_german2_ci&quot;) == &quot;Müller&quot;).compile(</span>
<span class="go">...         dialect=mysql.dialect()</span>
<span class="go">...     )</span>
<span class="go">... )</span>
<div class='show_sql_print'><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">latin1_german2_ci</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">%</span><span class="n">s</span>
</div></pre></div>
</div>
<p>要针对文字值使用 COLLATE，请使用   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.literal" title="sqlalchemy.sql.expression.literal"><code class="xref py py-func docutils literal notranslate"><span class="pre">literal()</span></code></a>  构造:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">literal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span>
<span class="go">...     (literal(&quot;Müller&quot;).collate(&quot;latin1_german2_ci&quot;) == column(&quot;x&quot;)).compile(</span>
<span class="go">...         dialect=mysql.dialect()</span>
<span class="go">...     )</span>
<span class="go">... )</span>
<div class='show_sql_print'><span class="p">(</span><span class="o">%</span><span class="n">s</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">latin1_german2_ci</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
</div></pre></div>
</div>
</div></blockquote>
</section>
<section id="id11">
<h2>算术运算符<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__add__" title="sqlalchemy.sql.expression.ColumnOperators.__add__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__add__()</span></code></a> ，  :meth:` _sql.ColumnOperators.__radd__`  （Python “<code class="docutils literal notranslate"><span class="pre">+</span></code>” 运算符）：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">{printsql}x + :x_1{stop}</span></pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="go">{printsql}:x_1 + x{stop}</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div><p>注意，当表达式的数据类型为   <a class="reference internal" href="type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a>  或类似的时，：meth:` _sql.ColumnOperators.__add__` 运算符将产生   <span class="xref std std-ref">字符串连接</span> 。</p>
</div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__sub__" title="sqlalchemy.sql.expression.ColumnOperators.__sub__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__sub__()</span></code></a> ，  :meth:` _sql.ColumnOperators.__rsub__`  （Python “<code class="docutils literal notranslate"><span class="pre">-</span></code>” 运算符）：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">{printsql}x - :x_1{stop}</span></pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="go">{printsql}:x_1 - x{stop}</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__mul__" title="sqlalchemy.sql.expression.ColumnOperators.__mul__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__mul__()</span></code></a> ，  :meth:` _sql.ColumnOperators.__rmul__`  （Python “<code class="docutils literal notranslate"><span class="pre">*</span></code>” 运算符）：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">{printsql}x * :x_1{stop}</span></pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="go">{printsql}:x_1 * x{stop}</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__truediv__" title="sqlalchemy.sql.expression.ColumnOperators.__truediv__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__truediv__()</span></code></a> ，  :meth:` _sql.ColumnOperators.__rtruediv__`  （Python “<code class="docutils literal notranslate"><span class="pre">/</span></code>” 运算符）。</p></li>
</ul>
<blockquote>
<div><p>这是 Python 的 <code class="docutils literal notranslate"><span class="pre">truediv</span></code> 运算符，它将确保发生整数真正的分割：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">{printsql}x / CAST(:x_1 AS NUMERIC){stop}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="go">{printsql}:x_1 / CAST(x AS NUMERIC){stop}</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0: </span>Python 的 <code class="docutils literal notranslate"><span class="pre">/</span></code> 运算符现在确保使用整数真正的除法。</p>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__floordiv__" title="sqlalchemy.sql.expression.ColumnOperators.__floordiv__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__floordiv__()</span></code></a> ，  :meth:` _sql.ColumnOperators.__rfloordiv__`  （Python “<code class="docutils literal notranslate"><span class="pre">//</span></code>” 运算符）。</p></li>
</ul>
<blockquote>
<div><p>这是 Python 的 <code class="docutils literal notranslate"><span class="pre">floordiv</span></code> 运算符，它将确保使用 floor division。对于默认后端以及后端（如 PostgreSQL），SQL <code class="docutils literal notranslate"><span class="pre">/</span></code> 运算符通常对整数值进行 floor division。：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">{printsql}x / :x_1{stop}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">//</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>
<span class="go">{printsql}:x_1 / x{stop}</span></pre></div>
</div>
<p>对于不使用 floor division 的后端或与数字值一起使用时，将使用 FLOOR() 函数以确保 floor division：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="go">{printsql}FLOOR(x / :x_1){stop}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">//</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">Numeric</span><span class="p">))</span>
<span class="go">{printsql}FLOOR(:x_1 / x){stop}</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0: </span>支持 FLOOR division</p>
</div>
</div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.__mod__" title="sqlalchemy.sql.expression.ColumnOperators.__mod__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.__mod__()</span></code></a> ，  :meth:` _sql.ColumnOperators.__rmod__`  （Python “<code class="docutils literal notranslate"><span class="pre">%</span></code>” 运算符）：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">{printsql}x % :x_1{stop}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">%</span> <span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="go">{printsql}:x_1 % x{stop}</span></pre></div>
</div>
</li>
</ul>
<blockquote>
<div></div></blockquote>
</section>
<section id="id12">
<h2>位运算符<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h2>
<p>按位运算符函数提供了跨不同后端进行位运算符统一访问，这些后端应以兼容的值（例如整数和位字符串（例如 PostgreSQL   <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.BIT" title="sqlalchemy.dialects.postgresql.BIT"><code class="xref py py-class docutils literal notranslate"><span class="pre">BIT</span></code></a>  等）进行操作。请注意，这些并不是一般的布尔运算符。</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.2: </span>为位运算添加了专用运算符。</p>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.bitwise_not" title="sqlalchemy.sql.expression.ColumnOperators.bitwise_not"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.bitwise_not()</span></code></a> ，  :func:` _sql.bitwise_not` 。作为一个列级方法，生成对父对象的按位 NOT 语句：</p></li>
</ul>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_not</span><span class="p">())</span>
<span class="go">~x</span></pre></div>
</div>
<p>该运算符也可用作列表达式级别的方法，将按位 NOT 应用于单个列表达式：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">bitwise_not</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">bitwise_not</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)))</span>
<span class="go">~x</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.bitwise_and" title="sqlalchemy.sql.expression.ColumnOperators.bitwise_and"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.bitwise_and()</span></code></a>  生成按位 AND：</p></li>
</ul>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">x &amp; :x_1</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.bitwise_or" title="sqlalchemy.sql.expression.ColumnOperators.bitwise_or"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.bitwise_or()</span></code></a>  生成 按位 OR：</p></li>
</ul>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_or</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">x | :x_1</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.bitwise_xor" title="sqlalchemy.sql.expression.ColumnOperators.bitwise_xor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.bitwise_xor()</span></code></a>  产生按位异或：</p></li>
</ul>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_xor</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">x ^ :x_1</span></pre></div>
</div>
<p>对于 PostgreSQL 方言，”#” 用于表示按位 XOR。使用这些后端之一时，会自动出现这样的情况：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects</span> <span class="kn">import</span> <span class="n">postgresql</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_xor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">postgresql</span><span class="o">.</span><span class="n">dialect</span><span class="p">()))</span>
<span class="go">x # %(x_1)s</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.bitwise_rshift" title="sqlalchemy.sql.expression.ColumnOperators.bitwise_rshift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.bitwise_rshift()</span></code></a> 、  :meth:` _sql.ColumnOperators.bitwise_lshift`</p></li>
</ul>
<blockquote>
<div><p>产生位移运算符：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_rshift</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">x &gt;&gt; :x_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwise_lshift</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">x &lt;&lt; :x_1</span></pre></div>
</div>
</div></blockquote>
</section>
<section id="id13">
<h2>使用连接和否定<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h2>
<p>最常见的连接符 “AND” 是在我们多次使用  <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.where" title="sqlalchemy.sql.expression.Select.where"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.where()</span></code></a>  方法时自动应用的，以及类似方法，
如  <a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Update.where" title="sqlalchemy.sql.expression.Update.where"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Update.where()</span></code></a>  和  :meth:` _sql.Delete.where`</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">  &gt;&gt;&gt; print(</span>
<span class="go">  ...     select(address_table.c.email_address)</span>
<span class="go">  ...     .where(user_table.c.name == &quot;squidward&quot;)</span>
<span class="go">  ...     .where(address_table.c.user_id == user_table.c.id)</span>
<span class="go">  ... )</span>
<span class="go">  {printsql}SELECT address.email_address</span>
<span class="go">  FROM address, user_account</span>
<span class="go">  WHERE user_account.name = :name_1 AND address.user_id = user_account.id</span>

<span class="go">:meth:`_sql.Select.where`  ，  :meth:` _sql.Update.where`  和  :meth:`_sql.Delete.where`  还接受多个表达式以达到同样的效果：</span>

<span class="go">  &gt;&gt;&gt; print(</span>
<span class="go">  ...     select(address_table.c.email_address).where(</span>
<span class="go">  ...         user_table.c.name == &quot;squidward&quot;,</span>
<span class="go">  ...         address_table.c.user_id == user_table.c.id,</span>
<span class="go">  ...     )</span>
<span class="go">  ... )</span>
<span class="go">  {printsql}SELECT address.email_address</span>
<span class="go">  FROM address, user_account</span>
<span class="go">  WHERE user_account.name = :name_1 AND address.user_id = user_account.id</span></pre></div>
</div>
<p>“And” 连接，以及它的对应的 “OR”，也可使用   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code></a>  和   :func:` _sql.or_`  函数直接使用：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">and_</span><span class="p">,</span> <span class="n">or_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">select</span><span class="p">(</span><span class="n">address_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">or_</span><span class="p">(</span><span class="n">user_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;squidward&quot;</span><span class="p">,</span> <span class="n">user_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;sandy&quot;</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">address_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span> <span class="o">==</span> <span class="n">user_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">{printsql}SELECT address.email_address</span>
<span class="go">FROM address, user_account</span>
<span class="go">WHERE (user_account.name = :name_1 OR user_account.name = :name_2)</span>
<span class="go">AND address.user_id = user_account.id</span></pre></div>
</div>
<p>使用   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.not_" title="sqlalchemy.sql.expression.not_"><code class="xref py py-func docutils literal notranslate"><span class="pre">not_()</span></code></a>  函数可以得到相反的效果。通常会反转布尔表达式中的运算符：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">not_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">not_</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">))</span>
<span class="go">{printsql}x != :x_1</span></pre></div>
</div>
<p>当合适时，也可应用关键字，例如 <code class="docutils literal notranslate"><span class="pre">NOT</span></code>：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Boolean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">not_</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">Boolean</span><span class="p">)))</span>
<span class="go">{printsql}NOT x</span></pre></div>
</div>
</section>
<section id="id14">
<h2>连接操作符<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h2>
<p>上述连接函数   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code></a> ,   :func:` _sql.or_`  和   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.not_" title="sqlalchemy.sql.expression.not_"><code class="xref py py-func docutils literal notranslate"><span class="pre">not_()</span></code></a>  也可作为重载的 Python 运算符使用：</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python 的 “&amp;”、”|” 和 “~” 运算符在语言中具有较高的优先级；因此，必须通常应用用于自身包含表达式的操作数，如下面的示例中所示。</p>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Operators.__and__" title="sqlalchemy.sql.expression.Operators.__and__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operators.__and__()</span></code></a> （Python “` <cite>&amp;`</cite>” 运算符）：</p></li>
</ul>
<blockquote>
<div><p>Python 二进制 “&amp;” 运算符被重载为与   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code></a>  表现相同，注意两个操作数周围的圆括号：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">((</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">{printsql}x = :x_1 AND y = :y_1</span></pre></div>
</div>
</div></blockquote>
<ul>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Operators.__or__" title="sqlalchemy.sql.expression.Operators.__or__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operators.__or__()</span></code></a> （Python “` <cite>|`</cite>” 运算符）：Python二进制“|”运算符被重载以与   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.or_" title="sqlalchemy.sql.expression.or_"><code class="xref py py-func docutils literal notranslate"><span class="pre">or_()</span></code></a>  相同（请注意两个操作数周围的括号）：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">((</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">{printsql}x = :x_1 OR y = :y_1</span></pre></div>
</div>
</li>
<li><p><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Operators.__invert__" title="sqlalchemy.sql.expression.Operators.__invert__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operators.__invert__()</span></code></a>  (Python “` <cite>~`</cite>” operator):</p></li>
</ul>
<p>Python二进制“~”运算符被重载以与   <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.not_" title="sqlalchemy.sql.expression.not_"><code class="xref py py-func docutils literal notranslate"><span class="pre">not_()</span></code></a>  相同，有时候用作翻转现有运算符，或者将”NOT”关键字应用于整个表达式中：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">))</span>
<span class="go">{printsql}x != :x_1{stop}</span></pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Boolean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="o">~</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">Boolean</span><span class="p">))</span>
<span class="go">{printsql}NOT x{stop}</span></pre></div>
</div>
</section>
</section>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="sqlelement.html" title="previous chapter">列元素和表达式</a>
        Next:
        <a href="selectable.html" title="next chapter">选择和相关结构</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2023, the SQLAlchemy authors and contributors.


    <p><b>flambé!</b> the dragon and <b><i>The Alchemist</i></b> image designs created and generously donated by <a href="https://github.com/vmalloc">Rotem Yaari</a>.</p>

        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 7.0.1.

    Documentation last generated: 2023/8/18 18:58:45

    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '2.0.19',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script type="text/javascript" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
        <script type="text/javascript" src="../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


