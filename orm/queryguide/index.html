<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>
            
    
    ORM 查询指南
 &mdash;
    SQLAlchemy 2.0 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
                <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
                <link rel="stylesheet" href="../../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
        <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="SQLAlchemy 2.0 Documentation" href="../../index.html" />
        <link rel="up" title="SQLAlchemy ORM" href="../index.html" />
        <link rel="next" title="使用ORM映射类编写SELECT语句" href="select.html" />
        <link rel="prev" title="关系API" href="../relationship_api.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">2.0.19</span>


        | Release Date: July 15, 2023

    </div>

    <h1><a href="../../index.html">SQLAlchemy 2.0 Documentation</a></h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">



        <div id="docs-sidebar-popout">
            <h3><a href="../../index.html">SQLAlchemy 2.0 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../../index.html">Home</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="../index.html" title="SQLAlchemy ORM">SQLAlchemy ORM</a>
        </h3>

        <ul>
<li><span class="link-container"><a class="reference external" href="../quickstart.html">ORM快速入门</a></span></li>
<li><span class="link-container"><a class="reference external" href="../mapper_config.html">ORM映射类配置</a></span></li>
<li><span class="link-container"><a class="reference external" href="../relationships.html">关系配置</a></span></li>
<li class="selected"><span class="link-container"><strong>ORM 查询指南</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container"><a class="reference external" href="select.html">使用ORM映射类编写SELECT语句</a></span></li>
<li><span class="link-container"><a class="reference external" href="inheritance.html">继承映射中编写SELECT语句</a></span></li>
<li><span class="link-container"><a class="reference external" href="dml.html">ORM-启用的INSERT、UPDATE和DELETE语句</a></span></li>
<li><span class="link-container"><a class="reference external" href="columns.html">列加载选项</a></span></li>
<li><span class="link-container"><a class="reference external" href="relationships.html">关系加载技术</a></span></li>
<li><span class="link-container"><a class="reference external" href="api.html">查询时使用的ORM API功能</a></span></li>
<li><span class="link-container"><a class="reference external" href="query.html">Legacy查询API</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="../session.html">用 Session</a></span></li>
<li><span class="link-container"><a class="reference external" href="../extending.html">事件和内部机制</a></span></li>
<li><span class="link-container"><a class="reference external" href="../extensions/index.html">ORM扩展</a></span></li>
<li><span class="link-container"><a class="reference external" href="../examples.html">ORM 示例</a></span></li>
</ul>



        </div>

        </div>

    </div>

    <div id="narrow-index-nav">
        <form class="search" action="../../search.html" method="get">
            <label>
                Search terms:
            <input type="text" placeholder="search..." name="q" size="12" />
            </label>
            <input type="submit" value="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>

        <p>
        <a href="../../index.html">Home</a>
        </p>

    </div>


        <div id="docs-narrow-top-navigation">
            <ul>
                <li><b>Previous:</b>
                <a href="../relationship_api.html" title="previous chapter">关系API</a></li>
                <li><b>Next:</b>
                <a href="select.html" title="next chapter">使用ORM映射类编写SELECT语句</a></li>

            <li><b>Up:</b> <a href="../../index.html">Home</a></li>
                    <ul><li><a href="../index.html" title="SQLAlchemy ORM">SQLAlchemy ORM</a></li>
                </ul>



            <li><b>On this page:</b></li>
            <ul>
<li><a class="reference internal" href="#orm">ORM 查询指南</a></li>
</ul>


            </ul>

        </div>



    <div id="docs-body" role="main" class="withsidebar orm-queryguide-index" >
        
<section id="orm">
<span id="queryguide-toplevel"></span><h1>ORM 查询指南<a class="headerlink" href="#orm" title="Permalink to this heading">¶</a></h1>
<p>本节提供了使用 SQLAlchemy ORM 发出查询的概述，使用了  <span class="xref std std-term">2.0 style</span> .
本节的读者应该熟悉   <a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy统一教程</span></a>  中的 SQLAlchemy 概述，
特别是大部分的内容都是在   <a class="reference internal" href="../../tutorial/data_select.html#tutorial-selecting-data"><span class="std std-ref">使用SELECT语句</span></a>  的基础上拓展的。</p>
<div class="admonition-sqlalchemy-1-x admonition">
<p class="admonition-title">对于 SQLAlchemy 1.x 的用户</p>
<p>在 SQLAlchemy 2.x 系列中，ORM 的 SQL SELECT 语句是使用与 Core 中相同的   <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a>  构造而建造的，
然后使用   <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>  的  :meth:` _orm.Session.execute`  方法（与用于   <a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">ORM-启用的INSERT、UPDATE和DELETE语句</span></a>
功能的   <a class="reference internal" href="../../core/dml.html#sqlalchemy.sql.expression.update" title="sqlalchemy.sql.expression.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a>  和   :func:` _sql.delete`  构造相同）来调用。但是，旧版的   <a class="reference internal" href="query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
对象同时执行这些步骤，作为一个“全能”的对象，它仍然是可用的，以支持在没有必要全面替换所有查询的情况下建立在 1.x
系列上的应用程序。关于这个对象的参考，可以查看   <a class="reference internal" href="query.html"><span class="std std-ref">Legacy查询API</span></a> 。</p>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="select.html">使用ORM映射类编写SELECT语句</a><ul>
<li class="toctree-l2"><a class="reference internal" href="select.html#orm">选择ORM实体和属性</a><ul>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-select-orm-entities">选择ORM实体</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-select-multiple-entities">同时选择多个ORM实体</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#id3">选择单个属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#bundles">使用 Bundles 分组选择的属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-orm-aliases">选择 ORM 别名</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-selecting-text">从文本语句获取 ORM 结果</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-subqueries">从子查询中选择实体</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#unions">从UNIONs和其他集合操作中选择实体</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="select.html#orm-queryguide-joins">连接</a><ul>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-simple-relationship-join">简单的关系联接</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#id12">级联多个连接</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#id15">连接到目标实体</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#on">使用ON子句连接到目标</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#relationship-on">将 Relationship 与自定义 ON 条件组合</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#relationship">使用 Relationship 在别名目标之间进行连接</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-join-subqueries">与子查询连接</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#id21">通过关系路径连接到子查询</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#id22">引用多个实体的子查询</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="select.html#where">关系WHERE运算符</a><ul>
<li class="toctree-l3"><a class="reference internal" href="select.html#has-any">存在形式：has()/any()</a></li>
<li class="toctree-l3"><a class="reference internal" href="select.html#orm-queryguide-relationship-common-operators">关系实例比较操作符</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="inheritance.html">继承映射中编写SELECT语句</a><ul>
<li class="toctree-l2"><a class="reference internal" href="inheritance.html#id1">从基类和特定子类中选择</a></li>
<li class="toctree-l2"><a class="reference internal" href="inheritance.html#selectin-polymorphic">使用 selectin_polymorphic()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#polymorphic-selectin-w-loader-options">将其他加载器选项与selectin_polymorphic()子类加载器结合使用</a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#polymorphic-selectin-as-loader-option-target">将selectin_polymorphic()应用于现有的急性加载</a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#id8">在映射器上配置 selectin_polymorphic()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inheritance.html#with-polymorphic">使用 with_polymorphic()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#with-polymorphic-subclass-attributes">使用 with_polymorphic() 过滤子类的属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#with-polymorphic-aliasing">使用 with_polymorphic 进行别名处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#with-polymorphic-mapper-config">在映射器上配置 with_polymorphic()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inheritance.html#inheritance-of-type">连接到特定子类型或 with_polymorphic() 实体</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#eagerloading-polymorphic-subtypes">多态子类型的急加载</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inheritance.html#loading-single-inheritance">单继承映射的 SELECT 语句</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#id16">提高单继承属性的加载性能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inheritance.html#api">继承加载API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#sqlalchemy.orm.with_polymorphic"><code class="docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html#sqlalchemy.orm.selectin_polymorphic"><code class="docutils literal notranslate"><span class="pre">selectin_polymorphic()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dml.html">ORM-启用的INSERT、UPDATE和DELETE语句</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dml.html#orminsert">ORM大容量INSERT语句</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dml.html#returning">将 RETURNING 记录与输入数据顺序相关联</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html#orm-queryguide-insert-values">使用每行SQL表达式的ORM批量插入</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html#upsertreturning">在upsert语句中使用RETURNING</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dml.html#ormupdate">ORM基于主键的批量UPDATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="dml.html#whereorm-update-and-delete">带有自定义WHERE条件的ORM UPDATE and DELETE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="columns.html">列加载选项</a><ul>
<li class="toctree-l2"><a class="reference internal" href="columns.html#orm-queryguide-column-deferral">使用列延迟选择要加载的列</a><ul>
<li class="toctree-l3"><a class="reference internal" href="columns.html#load-only">使用“load_only()”减少加载列</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#defer">使用 <code class="docutils literal notranslate"><span class="pre">defer()</span></code> 省略特定列</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#raiseload">使用raiseload防止延迟列加载</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="columns.html#orm-queryguide-deferred-declarative">配置映射的列缓期</a><ul>
<li class="toctree-l3"><a class="reference internal" href="columns.html#deferred-sql">使用 <code class="docutils literal notranslate"><span class="pre">deferred()</span></code> 用于命令式映射，映射 SQL 表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#undefer">使用 <code class="docutils literal notranslate"><span class="pre">undefer()</span></code> 来“急切”加载延迟列</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#orm-queryguide-deferred-group">按组加载待决列</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#id17">使用通配符undefer</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#mapper-level-raiseload">配置默认的 mapper-level “raiseload” 行为</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="columns.html#sql">将任意SQL表达式加载到对象上</a><ul>
<li class="toctree-l3"><a class="reference internal" href="columns.html#union-with-expression">在 UNION 和其他子查询中使用 <code class="docutils literal notranslate"><span class="pre">with_expression()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="columns.html#api">列加载 API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.defer"><code class="docutils literal notranslate"><span class="pre">defer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.deferred"><code class="docutils literal notranslate"><span class="pre">deferred()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.query_expression"><code class="docutils literal notranslate"><span class="pre">query_expression()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.load_only"><code class="docutils literal notranslate"><span class="pre">load_only()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.undefer"><code class="docutils literal notranslate"><span class="pre">undefer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.undefer_group"><code class="docutils literal notranslate"><span class="pre">undefer_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html#sqlalchemy.orm.with_expression"><code class="docutils literal notranslate"><span class="pre">with_expression()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="relationships.html">关系加载技术</a><ul>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#id6">关系加载类型的概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#id7">使用加载器选项加载关系</a><ul>
<li class="toctree-l3"><a class="reference internal" href="relationships.html#id8">加载器选项添加筛选条件</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#lazy-loading">惰性加载</a></li>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#joined-eager-loading">连接的及早加载</a></li>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#in">选择 IN 的加载</a></li>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#subquery-eager-loading">子查询急加载</a></li>
<li class="toctree-l2"><a class="reference internal" href="relationships.html#relationship-loader-api">Relationship Loader API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="relationships.html#sqlalchemy.orm.Load"><code class="docutils literal notranslate"><span class="pre">Load</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">查询时使用的ORM API功能</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#orm">ORM加载器选项</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#orm-queryguide-execution-options">ORM执行选项</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#orm-queryguide-populate-existing">填充现有的实例</a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#orm-queryguide-autoflush">自动刷新</a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#queryguide-identity-token">标识符令牌</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="query.html">Legacy查询API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="query.html#id1">查询对象</a><ul>
<li class="toctree-l3"><a class="reference internal" href="query.html#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">Query</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="query.html#orm">ORM特定的查询构造函数</a></li>
</ul>
</li>
</ul>
</div>
</section>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="../relationship_api.html" title="previous chapter">关系API</a>
        Next:
        <a href="select.html" title="next chapter">使用ORM映射类编写SELECT语句</a>

    <div id="docs-copyright">
        &copy; <a href="../../copyright.html">Copyright</a> 2007-2023, the SQLAlchemy authors and contributors.


    <p><b>flambé!</b> the dragon and <b><i>The Alchemist</i></b> image designs created and generously donated by <a href="https://github.com/vmalloc">Rotem Yaari</a>.</p>

        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 7.0.1.

    Documentation last generated: 2023/8/18 18:59:02

    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../../',
          VERSION:     '2.0.19',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script type="text/javascript" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/sphinx_highlight.js"></script>
        <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../../_static/init.js"></script>


    </body>
</html>


